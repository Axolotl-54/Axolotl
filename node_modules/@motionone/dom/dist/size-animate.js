class t{setAnimation(t){this.animation=t,null==t||t.finished.then((()=>this.clearAnimation())).catch((()=>{}))}clearAnimation(){this.animation=this.generator=void 0}}const e=new WeakMap;function i(t){return e.has(t)||e.set(t,{transforms:[],values:new Map}),e.get(t)}const n=(t,e,i)=>Math.min(Math.max(i,t),e),a={duration:.3,delay:0,endDelay:0,repeat:0,easing:"ease"},s=t=>"number"==typeof t,r=t=>Array.isArray(t)&&!s(t[0]);const o=(t,e,i)=>-i*t+i*e+t,l=()=>{},c=t=>t,u=(t,e,i)=>e-t==0?1:(i-t)/(e-t);function h(t,e){const i=t[t.length-1];for(let n=1;n<=e;n++){const a=u(0,e,n);t.push(o(i,1,a))}}function d(t,e=function(t){const e=[0];return h(e,t-1),e}(t.length),i=c){const a=t.length,s=a-e.length;return s>0&&h(e,s),s=>{let l=0;for(;l<a-2&&!(s<e[l+1]);l++);let c=n(0,1,u(e[l],e[l+1],s));const h=function(t,e){return r(t)?t[((t,e,i)=>{const n=e-t;return((i-t)%n+n)%n+t})(0,t.length,e)]:t}(i,l);return c=h(c),o(t[l],t[l+1],c)}}const f=t=>"object"==typeof t&&Boolean(t.createAnimation),m=t=>"function"==typeof t,p=t=>1e3*t,y=t=>t/1e3,g=["","X","Y","Z"],v={x:"translateX",y:"translateY",z:"translateZ"},T={syntax:"<angle>",initialValue:"0deg",toDefaultUnit:t=>t+"deg"},S={translate:{syntax:"<length-percentage>",initialValue:"0px",toDefaultUnit:t=>t+"px"},rotate:T,scale:{syntax:"<number>",initialValue:1,toDefaultUnit:c},skew:T},w=new Map,A=t=>`--motion-${t}`,b=["x","y","z"];["translate","scale","rotate","skew"].forEach((t=>{g.forEach((e=>{b.push(t+e),w.set(A(t+e),S[t])}))}));const D=(t,e)=>b.indexOf(t)-b.indexOf(e),k=new Set(b),x=t=>k.has(t),O=t=>t.sort(D).reduce(M,"").trim(),M=(t,e)=>`${t} ${e}(var(${A(e)}))`,E=t=>t.startsWith("--"),R=new Set;const P=(t,e,i)=>(((1-3*i+3*e)*t+(3*i-6*e))*t+3*e)*t;function j(t,e,i,n){if(t===e&&i===n)return c;const a=e=>function(t,e,i,n,a){let s,r,o=0;do{r=e+(i-e)/2,s=P(r,n,a)-t,s>0?i=r:e=r}while(Math.abs(s)>1e-7&&++o<12);return r}(e,0,1,t,i);return t=>0===t||1===t?t:P(a(t),e,n)}const V={ease:j(.25,.1,.25,1),"ease-in":j(.42,0,1,1),"ease-in-out":j(.42,0,.58,1),"ease-out":j(0,0,.58,1)},$=/\((.*?)\)/;function q(t){if(m(t))return t;if(Array.isArray(t))return j(...t);if(V[t])return V[t];if(t.startsWith("steps")){const e=$.exec(t);if(e){const t=e[1].split(",");return((t,e="end")=>i=>{const a=(i="end"===e?Math.min(i,.999):Math.max(i,.001))*t,s="end"===e?Math.floor(a):Math.ceil(a);return n(0,1,s/t)})(parseFloat(t[0]),t[1].trim())}}return c}class F{constructor(t,e=[0,1],{easing:i,duration:n=a.duration,delay:s=a.delay,endDelay:o=a.endDelay,repeat:l=a.repeat,offset:u,direction:h="normal"}={}){if(this.startTime=null,this.rate=1,this.t=0,this.cancelTimestamp=null,this.easing=c,this.duration=0,this.totalDuration=0,this.repeat=0,this.playState="idle",this.finished=new Promise(((t,e)=>{this.resolve=t,this.reject=e})),i=i||a.easing,f(i)){const t=i.createAnimation(e,(()=>"0"),!0);i=t.easing,void 0!==t.keyframes&&(e=t.keyframes),void 0!==t.duration&&(n=t.duration)}this.repeat=l,this.easing=r(i)?c:q(i),this.updateDuration(n);const m=d(e,u,r(i)?i.map(q):c);this.tick=e=>{var i;let n=0;n=void 0!==this.pauseTime?this.pauseTime:(e-this.startTime)*this.rate,this.t=n,n/=1e3,n=Math.max(n-s,0),"finished"===this.playState&&void 0===this.pauseTime&&(n=this.totalDuration);const a=n/this.duration;let r=Math.floor(a),l=a%1;!l&&a>=1&&(l=1),1===l&&r--;const c=r%2;("reverse"===h||"alternate"===h&&c||"alternate-reverse"===h&&!c)&&(l=1-l);const u=n>=this.totalDuration?1:Math.min(l,1),d=m(this.easing(u));t(d);void 0===this.pauseTime&&("finished"===this.playState||n>=this.totalDuration+o)?(this.playState="finished",null===(i=this.resolve)||void 0===i||i.call(this,d)):"idle"!==this.playState&&(this.frameRequestId=requestAnimationFrame(this.tick))},this.play()}play(){const t=performance.now();this.playState="running",void 0!==this.pauseTime?this.startTime=t-this.pauseTime:this.startTime||(this.startTime=t),this.cancelTimestamp=this.startTime,this.pauseTime=void 0,this.frameRequestId=requestAnimationFrame(this.tick)}pause(){this.playState="paused",this.pauseTime=this.t}finish(){this.playState="finished",this.tick(0)}stop(){var t;this.playState="idle",void 0!==this.frameRequestId&&cancelAnimationFrame(this.frameRequestId),null===(t=this.reject)||void 0===t||t.call(this,!1)}cancel(){this.stop(),this.tick(this.cancelTimestamp)}reverse(){this.rate*=-1}commitStyles(){}updateDuration(t){this.duration=t,this.totalDuration=t*(this.repeat+1)}get currentTime(){return this.t}set currentTime(t){void 0!==this.pauseTime||0===this.rate?this.pauseTime=t:this.startTime=performance.now()-t/this.rate}get playbackRate(){return this.rate}set playbackRate(t){this.rate=t}}const U=(t,e)=>document.createElement("div").animate(t,e),C={cssRegisterProperty:()=>"undefined"!=typeof CSS&&Object.hasOwnProperty.call(CSS,"registerProperty"),waapi:()=>Object.hasOwnProperty.call(Element.prototype,"animate"),partialKeyframes:()=>{try{U({opacity:[1]})}catch(t){return!1}return!0},finished:()=>Boolean(U({opacity:[0,1]},{duration:.001}).finished),linearEasing:()=>{try{U({opacity:0},{easing:"linear(0, 1)"})}catch(t){return!1}return!0}},I={},_={};for(const t in C)_[t]=()=>(void 0===I[t]&&(I[t]=C[t]()),I[t]);const W=(t,e)=>m(t)?_.linearEasing()?`linear(${((t,e)=>{let i="";const n=Math.round(e/.015);for(let e=0;e<n;e++)i+=t(u(0,n-1,e))+", ";return i.substring(0,i.length-2)})(t,e)})`:a.easing:(t=>Array.isArray(t)&&s(t[0]))(t)?z(t):t,z=([t,e,i,n])=>`cubic-bezier(${t}, ${e}, ${i}, ${n})`;function B(t){return v[t]&&(t=v[t]),x(t)?A(t):t}const K=(t,e)=>{e=B(e);let i=E(e)?t.style.getPropertyValue(e):getComputedStyle(t)[e];if(!i&&0!==i){const t=w.get(e);t&&(i=t.initialValue)}return i},N=(t,e,i)=>{e=B(e),E(e)?t.style.setProperty(e,i):t.style[e]=i};function X(t,e=!0){if(t&&"finished"!==t.playState)try{t.stop?t.stop():(e&&t.commitStyles(),t.cancel())}catch(t){}}function Y(e,n,o,c={}){const u=window.__MOTION_DEV_TOOLS_RECORD,h=!1!==c.record&&u;let d,{duration:y=a.duration,delay:g=a.delay,endDelay:T=a.endDelay,repeat:S=a.repeat,easing:A=a.easing,direction:b,offset:D,allowWebkitAcceleration:k=!1}=c;const M=i(e),P=x(n);let j=_.waapi();P&&((t,e)=>{v[e]&&(e=v[e]);const{transforms:n}=i(t);var a,s;s=e,-1===(a=n).indexOf(s)&&a.push(s),t.style.transform=O(n)})(e,n);const V=B(n),$=function(e,i){return e.has(i)||e.set(i,new t),e.get(i)}(M.values,V),q=w.get(V);return X($.animation,!(f(A)&&$.generator)&&!1!==c.record),()=>{const t=()=>{var t,i;return null!==(i=null!==(t=K(e,V))&&void 0!==t?t:null==q?void 0:q.initialValue)&&void 0!==i?i:0};let i=function(t,e){for(let i=0;i<t.length;i++)null===t[i]&&(t[i]=i?t[i-1]:e());return t}((t=>Array.isArray(t)?t:[t])(o),t);if(f(A)){const e=A.createAnimation(i,t,P,V,$);A=e.easing,void 0!==e.keyframes&&(i=e.keyframes),void 0!==e.duration&&(y=e.duration)}if(E(V)&&(_.cssRegisterProperty()?function(t){if(!R.has(t)){R.add(t);try{const{syntax:e,initialValue:i}=w.has(t)?w.get(t):{};CSS.registerProperty({name:t,inherits:!1,syntax:e,initialValue:i})}catch(t){}}}(V):j=!1),P&&!_.linearEasing()&&(m(A)||r(A)&&A.some(m))&&(j=!1),j){q&&(i=i.map((t=>s(t)?q.toDefaultUnit(t):t))),1!==i.length||_.partialKeyframes()&&!h||i.unshift(t());const n={delay:p(g),duration:p(y),endDelay:p(T),easing:r(A)?void 0:W(A,y),direction:b,iterations:S+1,fill:"both"};d=e.animate({[V]:i,offset:D,easing:r(A)?A.map((t=>W(t,y))):void 0},n),d.finished||(d.finished=new Promise(((t,e)=>{d.onfinish=t,d.oncancel=e})));const a=i[i.length-1];d.finished.then((()=>{N(e,V,a),d.cancel()})).catch(l),k||(d.playbackRate=1.000001)}else if(P){i=i.map((t=>"string"==typeof t?parseFloat(t):t)),1===i.length&&i.unshift(parseFloat(t()));d=new F((t=>{q&&(t=q.toDefaultUnit(t)),N(e,V,t)}),i,Object.assign(Object.assign({},c),{duration:y,easing:A}))}else{const t=i[i.length-1];N(e,V,q&&s(t)?q.toDefaultUnit(t):t)}return h&&u(e,n,i,{duration:y,delay:g,easing:A,repeat:S,offset:D},"motion-one"),$.setAnimation(d),d}}const Z=(t,e)=>t[e]?Object.assign(Object.assign({},t),t[e]):Object.assign({},t);const L=t=>t(),G={get:(t,e)=>{const i=t.animations[0];switch(e){case"duration":return t.duration;case"currentTime":return y((null==i?void 0:i[e])||0);case"playbackRate":case"playState":return null==i?void 0:i[e];case"finished":return t.finished||(t.finished=Promise.all(t.animations.map(H)).catch(l)),t.finished;case"stop":return()=>{t.animations.forEach((t=>X(t)))};case"forEachNative":return e=>{t.animations.forEach((i=>e(i,t)))};default:return void 0===(null==i?void 0:i[e])?void 0:()=>t.animations.forEach((t=>t[e]()))}},set:(t,e,i)=>{switch(e){case"currentTime":i=p(i);case"currentTime":case"playbackRate":for(let n=0;n<t.animations.length;n++)t.animations[n][e]=i;return!0}return!1}},H=t=>t.finished;function J(t,e,i){return m(t)?t(e,i):t}function Q(t,e,i={}){const n=(t=function(t,e){var i;return"string"==typeof t?e?(null!==(i=e[t])&&void 0!==i||(e[t]=document.querySelectorAll(t)),t=e[t]):t=document.querySelectorAll(t):t instanceof Element&&(t=[t]),Array.from(t||[])}(t)).length,s=[];for(let a=0;a<n;a++){const r=t[a];for(const t in e){const o=Z(i,t);o.delay=J(o.delay,a,n);const l=Y(r,t,e[t],o);s.push(l)}}return((t,e,i=a.duration)=>new Proxy({animations:t.map(L).filter(Boolean),duration:i,options:e},G))(s,i,i.duration)}export{Q as animate};
